body {
  display: flex;
  flex-direction: column; /* 가로 → 세로 정렬 */
  align-items: center;
  justify-content: flex-start;
  background-color: #f5f5f5;
  font-family: arial;  
  padding-bottom: 100px;  /* 컨트롤 버튼이 다른 콘텐츠를 가리지 않도록 body에 하단 여백 추가 */
  /* 추가: 터치 동작 시 부드러운 스크롤링과 같은 기본 동작을 막기 위함 */
  touch-action: none; 
  user-select: none;
}

:root {
  --key-center-color: #77aa77; /* 중앙 키 색상과 동일하게 설정 */
}

.layer {           /* 레이어(NUM,SYM,EN,KR) 숨김/표시 */
  display: none;
}
.layer.active {    /* 활성 레이어 */
  display: block;
}

#layer-switcher {
  position: fixed;   /* layer-switcher를 화면 하단에 고정 */
  bottom: 2px; /* 화면 하단에서의 여백 */
  left: 50%;
  transform: translateX(-50%); /* 수평 중앙 정렬 */
  
  /* [수정됨] 뷰포트 너비의 95%를 사용하되, 너무 커지는 것을 방지하기 위해 최대 너비 설정 */
  width: 95vw;
  max-width: 450px; 

  display: flex;
  flex-direction: column; /* 자식 요소(줄)들을 세로로 정렬 */
  align-items: center;   /* 가운데 정렬 */
  gap: 2px;             /* 줄 사이의 간격 */
  padding: 2px;  
  background-color: #f5f5f5; /* 배경색 추가 */
  border-radius: 5px; /* 모서리를 둥글게 */
  box-shadow: 0 -2px 5px rgba(0,0,0,0.1); /* 그림자 효과 */
}

.button-row {
  width: 100%;  /* 부모 요소의 전체 너비를 차지 */
  display: flex;
  margin-top: 2px;
  margin-left: 2px;
  margin-right: 2px;  
  justify-content: space-around; /* space-between; 버튼들을 좌우로 균등하게 배분 */
}

#layer-switcher button {
  background: #e0e0e0;
  border: 1px solid #aaa;
  padding: 1px 1px;  
  flex-grow: 1;     /* 버튼들이 가로 공간을 채우도록 함 */
  margin: 0px 2px;  /* margin: 0px;  균등 배분을 위해 제거하거나 0으로 설정 */
  cursor: pointer;
}

#layer-switcher button.active {
  background-color: var(--key-center-color);  /* 녹색 (#77aa77) */
  border-color: var(--key-center-color);
  color: #fff;
}

#layer-switcher button.caps-on {   /* EN 버튼이 Caps Lock 상태일 때 적용될 스타일 */
  background-color: #4a90e2;      /* 파란색으로 변경 */
  border-color: #4a90e2;
  color: white;
}

#layer-switcher button.qwerty-on {   /* K 버튼이 KE 모드일 때 적용될 스타일 */
  background-color: #4a90e2;      /* 파란색으로 변경 (Caps Lock과 동일) */
  border-color: #4a90e2;
  color: white;
}

/* [수정됨] 웹 테스트를 위한 디스플레이 컨테이너. 키보드 앱에서는 이 부분이 필요 없을 수 있음. */
#display-container {     
  width: 95vw;
  max-width: 450px;
  height: 150px; /* 높이 약간 줄임 */
  margin-top: 10px;
}

#display {      /* 글자 표시창 */
  width: 100%; /* 부모 컨테이너에 꽉 차게 변경 */
  height: 100%;
  font-size: 18px;
  background-color: #f0f0f0;
  border-radius: 5px;
  overflow-y: auto;
  box-sizing: border-box; /* 패딩, 보더가 너비/높이에 포함되도록 설정 */
}

#haromaInput[readonly] {
  caret-color: transparent; /* 커서 깜빡임 제거 */
}

#keyboard-container {
  display: block;
  bottom: 115px;
  left: 50%;
  margin-bottom: 2px;
  transform-origin: bottom;
  transition: transform 0.1s ease-in-out;  
  position: relative;
  touch-action: none;
  user-select: none;
  /* [추가됨] 키보드 컨테이너의 너비를 여기서 제어 */
  width: 90vw; /* 화면 너비의 90% */
  max-width: 400px; /* 태블릿 등에서 너무 커지지 않게 제한 */
}

svg {
  width: 100%;
  height: 100%;
}

.keyboard {
    /* [수정됨] 너비와 높이를 1:1 비율로 유지하기 위한 트릭 */
    width: 100%;
    height: auto; /* 높이는 자동으로 조절 */
    aspect-ratio: 1 / 1; /* 가로:세로 비율을 1:1로 강제 */
    border-radius: 2px;
}

button {     /* 숫자,기호,영어,한글... 좌,우,Clear 버튼 */
  width: 55px;
  height: 30px;
  cursor: pointer;
  font-size: 1rem;
}

/* ... (나머지 .octagon, .modal 등 스타일은 그대로 유지) ... */
.octagon-center {
  fill: #6cbf72; 
  stroke: #144455; 
  stroke-width: 0.5;
}

.octagon-small1, .octagon-small2, .octagon-small3, .octagon-small4, 
.octagon-small5, .octagon-small6, .octagon-small7, .octagon-small8 {
  fill: #84cc86; 
  stroke: #144455; 
  stroke-width: 0.5;
}

.octagon-big1, .octagon-big2, .octagon-big3, .octagon-big4, 
.octagon-big5, .octagon-big6, .octagon-big7, .octagon-big8 {
  fill: #a3dfaa;  
  stroke: #144455;  
  stroke-width: 0.5;
}

/* Settings Modal Styles */
.modal {
  display: none; /* Hidden by default */
  position: fixed; 
  z-index: 1000; /* Sit on top */
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
} 

.modal-content {
  background-color: #fefefe;
  margin: 15% auto;
  padding: 20px;
  border: 1px solid #888;
  width: 80%;
  max-width: 300px;
  border-radius: 10px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  text-align: center;
}

.close-button {
  color: #aaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close-button:hover,
.close-button:focus {
  color: black;
  text-decoration: none;
  cursor: pointer;
}

.settings-controls .control-group {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}

.settings-controls label {
    flex-basis: 30%;
    text-align: center;
}

.settings-controls button {
    width: 40px;
    height: 40px;
    font-size: 1.2rem;
}